D:\miniconda3\envs\pyqt5\python.exe D:\workspace_python\ChatRoom\server\chat_server.py 
20251224 17:50:55 | MainProcess | MainThread | chat_server.initialize | INFO | 数据库引擎初始化成功
20251224 17:50:55 | MainProcess | MainThread | chat_server.initialize | INFO | 连接管理器初始化成功
20251224 17:50:55 | MainProcess | MainThread | chat_server.start | INFO | 服务器启动成功，监听地址: 0.0.0.0:8888
服务器启动成功，监听地址: 0.0.0.0:8888
等待客户端连接...
20251224 17:50:58 | MainProcess | MainThread | chat_server._accept_connections | INFO | 新连接来自: ('127.0.0.1', 58948)
2025-12-24 17:51:04,097 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2025-12-24 17:51:04,097 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-24 17:51:04,101 INFO sqlalchemy.engine.Engine select current_schema()
2025-12-24 17:51:04,101 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-24 17:51:04,103 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2025-12-24 17:51:04,103 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-24 17:51:04,106 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:04,123 INFO sqlalchemy.engine.Engine SELECT users.user_id, users.username, users.display_name, users.avatar_url, users.password_hash, users.email, users.phone, users.status, users.last_seen, users.created_at, users.updated_at 
FROM users 
WHERE users.username = $1::VARCHAR
2025-12-24 17:51:04,125 INFO sqlalchemy.engine.Engine [generated in 0.00022s] ('ljy',)
20251224 17:51:04 | MainProcess | MainThread | users_crud.get_by_username | INFO | 获取用户成功: <common.database.models.users.Users object at 0x0000027159A48100>
2025-12-24 17:51:04,179 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-24 17:51:04,183 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:04,185 INFO sqlalchemy.engine.Engine INSERT INTO global_messages (user_id, content_type, content, file_url, file_name, file_size, metadata, edited_at, deleted_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::BIGINT, $7::JSONB, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE) RETURNING global_messages.message_id, global_messages.is_edited, global_messages.is_deleted, global_messages.created_at, global_messages.updated_at
2025-12-24 17:51:04,185 INFO sqlalchemy.engine.Engine [generated in 0.00027s] (None, 'system', 'ljy 加入了聊天室', None, None, 0, '{"timestamp": 1766569864.1806514, "is_system": true}', None, None)
2025-12-24 17:51:04,191 INFO sqlalchemy.engine.Engine COMMIT
2025-12-24 17:51:04,196 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:04,199 INFO sqlalchemy.engine.Engine SELECT global_messages.message_id, global_messages.user_id, global_messages.content_type, global_messages.content, global_messages.file_url, global_messages.file_name, global_messages.file_size, global_messages.metadata, global_messages.is_edited, global_messages.edited_at, global_messages.is_deleted, global_messages.deleted_at, global_messages.created_at, global_messages.updated_at 
FROM global_messages 
WHERE global_messages.message_id = $1::UUID
2025-12-24 17:51:04,199 INFO sqlalchemy.engine.Engine [generated in 0.00026s] (UUID('8c0b7fcf-1960-4174-9c68-b777abfc4f74'),)
20251224 17:51:04 | MainProcess | MainThread | global_messages_crud.create | INFO | 创建全局消息成功: <common.database.models.global_messages.GlobalMessage object at 0x0000027159808AF0>
2025-12-24 17:51:04,204 INFO sqlalchemy.engine.Engine ROLLBACK
20251224 17:51:04 | MainProcess | MainThread | client_handler._handle_login | INFO | 用户 ljy 登录成功
20251224 17:51:12 | MainProcess | MainThread | chat_server._accept_connections | INFO | 新连接来自: ('127.0.0.1', 58957)
2025-12-24 17:51:22,779 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:22,780 INFO sqlalchemy.engine.Engine SELECT users.user_id, users.username, users.display_name, users.avatar_url, users.password_hash, users.email, users.phone, users.status, users.last_seen, users.created_at, users.updated_at 
FROM users 
WHERE users.username = $1::VARCHAR
2025-12-24 17:51:22,780 INFO sqlalchemy.engine.Engine [cached since 18.66s ago] ('lpr',)
20251224 17:51:22 | MainProcess | MainThread | users_crud.get_by_username | INFO | 获取用户成功: None
20251224 17:51:22 | MainProcess | MainThread | users_crud.create | INFO | 开始创建用户
20251224 17:51:22 | MainProcess | MainThread | users_crud.create | INFO | 创建用户: <common.database.models.users.Users object at 0x0000027159A1BA30>
2025-12-24 17:51:22,826 INFO sqlalchemy.engine.Engine INSERT INTO users (username, display_name, avatar_url, password_hash, email, phone) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR) RETURNING users.user_id, users.status, users.last_seen, users.created_at, users.updated_at
2025-12-24 17:51:22,826 INFO sqlalchemy.engine.Engine [generated in 0.00018s] ('lpr', 'lpr', None, 'ipc5Uupiur2BCxli4GV2HJDyuhI9xkVvhDvhUbMmDfI=', None, None)
2025-12-24 17:51:22,832 INFO sqlalchemy.engine.Engine COMMIT
2025-12-24 17:51:22,838 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:22,840 INFO sqlalchemy.engine.Engine SELECT users.user_id, users.username, users.display_name, users.avatar_url, users.password_hash, users.email, users.phone, users.status, users.last_seen, users.created_at, users.updated_at 
FROM users 
WHERE users.user_id = $1::UUID
2025-12-24 17:51:22,840 INFO sqlalchemy.engine.Engine [generated in 0.00036s] (UUID('329ad422-8972-4da5-823b-a8a434f644c8'),)
20251224 17:51:22 | MainProcess | MainThread | users_crud.create | INFO | 创建用户成功: <common.database.models.users.Users object at 0x0000027159A1BA30>
2025-12-24 17:51:22,849 INFO sqlalchemy.engine.Engine ROLLBACK
20251224 17:51:22 | MainProcess | MainThread | client_handler._handle_register | INFO | 用户 lpr 注册成功
20251224 17:51:23 | MainProcess | MainThread | chat_server._accept_connections | INFO | 新连接来自: ('127.0.0.1', 58964)
2025-12-24 17:51:35,147 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:35,147 INFO sqlalchemy.engine.Engine SELECT users.user_id, users.username, users.display_name, users.avatar_url, users.password_hash, users.email, users.phone, users.status, users.last_seen, users.created_at, users.updated_at 
FROM users 
WHERE users.username = $1::VARCHAR
2025-12-24 17:51:35,147 INFO sqlalchemy.engine.Engine [cached since 31.02s ago] ('lpr',)
20251224 17:51:35 | MainProcess | MainThread | users_crud.get_by_username | INFO | 获取用户成功: <common.database.models.users.Users object at 0x0000027159A71060>
2025-12-24 17:51:35,184 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-24 17:51:35,189 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:35,191 INFO sqlalchemy.engine.Engine INSERT INTO global_messages (user_id, content_type, content, file_url, file_name, file_size, metadata, edited_at, deleted_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::BIGINT, $7::JSONB, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE) RETURNING global_messages.message_id, global_messages.is_edited, global_messages.is_deleted, global_messages.created_at, global_messages.updated_at
2025-12-24 17:51:35,191 INFO sqlalchemy.engine.Engine [cached since 31.01s ago] (None, 'system', 'lpr 加入了聊天室', None, None, 0, '{"timestamp": 1766569895.1870522, "is_system": true}', None, None)
2025-12-24 17:51:35,194 INFO sqlalchemy.engine.Engine COMMIT
2025-12-24 17:51:35,201 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:35,201 INFO sqlalchemy.engine.Engine SELECT global_messages.message_id, global_messages.user_id, global_messages.content_type, global_messages.content, global_messages.file_url, global_messages.file_name, global_messages.file_size, global_messages.metadata, global_messages.is_edited, global_messages.edited_at, global_messages.is_deleted, global_messages.deleted_at, global_messages.created_at, global_messages.updated_at 
FROM global_messages 
WHERE global_messages.message_id = $1::UUID
2025-12-24 17:51:35,201 INFO sqlalchemy.engine.Engine [cached since 31s ago] (UUID('776a453e-44a2-4ee3-a49a-aebf14c8a95d'),)
20251224 17:51:35 | MainProcess | MainThread | global_messages_crud.create | INFO | 创建全局消息成功: <common.database.models.global_messages.GlobalMessage object at 0x00000271597CA650>
2025-12-24 17:51:35,204 INFO sqlalchemy.engine.Engine ROLLBACK
20251224 17:51:35 | MainProcess | MainThread | client_handler._handle_login | INFO | 用户 lpr 登录成功
2025-12-24 17:51:40,827 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:40,828 INFO sqlalchemy.engine.Engine INSERT INTO global_messages (user_id, content_type, content, file_url, file_name, file_size, metadata, edited_at, deleted_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::BIGINT, $7::JSONB, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE) RETURNING global_messages.message_id, global_messages.is_edited, global_messages.is_deleted, global_messages.created_at, global_messages.updated_at
2025-12-24 17:51:40,828 INFO sqlalchemy.engine.Engine [cached since 36.64s ago] (None, 'system', 'ljy 离开了聊天室', None, None, 0, '{"timestamp": 1766569900.8239636, "is_system": true}', None, None)
2025-12-24 17:51:40,829 INFO sqlalchemy.engine.Engine COMMIT
2025-12-24 17:51:40,834 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:40,835 INFO sqlalchemy.engine.Engine SELECT global_messages.message_id, global_messages.user_id, global_messages.content_type, global_messages.content, global_messages.file_url, global_messages.file_name, global_messages.file_size, global_messages.metadata, global_messages.is_edited, global_messages.edited_at, global_messages.is_deleted, global_messages.deleted_at, global_messages.created_at, global_messages.updated_at 
FROM global_messages 
WHERE global_messages.message_id = $1::UUID
2025-12-24 17:51:40,835 INFO sqlalchemy.engine.Engine [cached since 36.64s ago] (UUID('00542437-7bf5-4358-8a17-331dde5de1cc'),)
20251224 17:51:40 | MainProcess | MainThread | global_messages_crud.create | INFO | 创建全局消息成功: <common.database.models.global_messages.GlobalMessage object at 0x00000271598098A0>
2025-12-24 17:51:40,837 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-24 17:51:46,459 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:46,459 INFO sqlalchemy.engine.Engine INSERT INTO global_messages (user_id, content_type, content, file_url, file_name, file_size, metadata, edited_at, deleted_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::BIGINT, $7::JSONB, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE) RETURNING global_messages.message_id, global_messages.is_edited, global_messages.is_deleted, global_messages.created_at, global_messages.updated_at
2025-12-24 17:51:46,459 INFO sqlalchemy.engine.Engine [cached since 42.27s ago] (None, 'system', 'lpr 离开了聊天室', None, None, 0, '{"timestamp": 1766569906.456839, "is_system": true}', None, None)
2025-12-24 17:51:46,460 INFO sqlalchemy.engine.Engine COMMIT
2025-12-24 17:51:46,468 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-24 17:51:46,468 INFO sqlalchemy.engine.Engine SELECT global_messages.message_id, global_messages.user_id, global_messages.content_type, global_messages.content, global_messages.file_url, global_messages.file_name, global_messages.file_size, global_messages.metadata, global_messages.is_edited, global_messages.edited_at, global_messages.is_deleted, global_messages.deleted_at, global_messages.created_at, global_messages.updated_at 
FROM global_messages 
WHERE global_messages.message_id = $1::UUID
2025-12-24 17:51:46,468 INFO sqlalchemy.engine.Engine [cached since 42.27s ago] (UUID('c176ef98-acfc-4f08-82f9-d0b19d57471b'),)
20251224 17:51:46 | MainProcess | MainThread | global_messages_crud.create | INFO | 创建全局消息成功: <common.database.models.global_messages.GlobalMessage object at 0x000002715980A5C0>
2025-12-24 17:51:46,470 INFO sqlalchemy.engine.Engine ROLLBACK
